name: Android Build 13579
on:
push:
branches: [ main ]
workflow_dispatch:
jobs:
build:
runs-on: ubuntu-latest          if [ ! -f "buildozer.spec" ]; then echo "Logic-Gate Error: Spec Missing"; exit 1; fi

      - name: Strike The Anvil
        run: |
          # Use -v to see the exact point of soul-body detachment
          # Log redirection to ensure we don't lose the tail on failure
          buildozer -v android debug 2>&1 | tee build_log.txt
        env:
          BUILDOZER_ALLOW_ORG_NAME_AS_PACKAGE_NAME: 1

      - name: Find and Extract Body
        if: always()
        run: |
          mkdir -p output_apk
          find . -name "*.apk" -print -exec cp {} output_apk/ \;
          # Also grab the log if the build failed
          cp build_log.txt output_apk/ || true
          
      - name: Upload CITIZEN_X
        uses: actions/upload-artifact@v4
        with:
          name: CITIZEN_X_Fidelity_Package
          path: output_apk/
